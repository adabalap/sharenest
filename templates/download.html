{% extends "layout.html" %}
{% block content %}
<div class="card">
  <h2>Access Your File</h2>
  {% if file_info and not expired and not limit_reached %}
    <p>Enter the phrase to download <strong>{{ file_info.original_filename }}</strong>.</p>
  {% elif expired or limit_reached %}
    <p>This link is no longer available.</p>
  {% else %}
    <p>This link could not be found.</p>
  {% endif %}

  {% if expired or limit_reached %}
    <div class="centered-message">
      <h3>Link Expired</h3>
      <p>This file is no longer available for download.</p>
      <a href="{{ url_for('home') }}" class="btn btn-primary">Share Another File</a>
    </div>
  {% elif file_info %}
    <div class="file-info">
      <div>
        <dt>Downloads Left</dt>
        <dd>{{ file_info.max_downloads - file_info.download_count }}</dd>
      </div>
      <div>
        <dt>Expires in</dt>
        <dd>{{ expiry_pretty }}</dd>
      </div>
    </div>
    <form action="{{ url_for('download_after_pin', token=token) }}" method="post">
      <div class="form-group">
        <label for="security_phrase">Security Phrase</label>
        <input type="password" name="security_phrase" id="security_phrase" required>
      </div>
      <button type="submit" class="btn btn-primary">Unlock & Download</button>
    </form>
  {% else %}
      <div class="centered-message">
          <h3>Not Found</h3>
          <p>The requested file could not be found.</p>
      </div>
  {% endif %}
</div>
{% endblock %}